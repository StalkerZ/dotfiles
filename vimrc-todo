" ---------------------- BASIC CONFIGURATION ---------------------

syntax on "syntax highlighting
filetype on " detect file types
filetype plugin on " and load plugins for them
filetype indent on
runtime macros/matchit.vim " enable machit plugin to enchance '%'
colorscheme wombat256mod

set nocompatible " no vi compatibility
set number "line numbers
set autoread " reload files changes outside vim
set encoding=utf-8
set fileencoding=utf-8
set backspace=indent,eol,start "Insert mode backspace will delete over line breaks/auto-inserted indentation
set hidden "keep abandoned buffers in background
set fileformat=unix "unix line endings
set fileformats=unix
set viminfo='100,f1 "save up to 100 marks, enable capital marks
set nobackup         " remove .ext~ files
set writebackup
set noswapfile
set incsearch        " find the next match as we type the search
set hlsearch         " highlight searches by default
set wildmode=list:longest " suggestion for normal mode commands
set scrolloff=3     " keep cursor visible within 3 lines when scrolling
set expandtab       " use spaces instead of tabs
set autoindent      " autoindent based on line above, works most of the time
set smartindent     " smarter indent for C-like languages
set shiftwidth=2    " when reading, tabs are 2 spaces
set softtabstop=2   " in insert mode, tabs are 2 spaces
set textwidth=100   " no lines longer than 100 cols
set scrolloff=5     " show 5 lines before and after cursor
set whichwrap+=<,>,h,l,[,] " wrap left and right in all modes
set pastetoggle=<f9> " use f9 instead of :set paste and :set nopaste over SSH
set colorcolumn=100 " make a mark for column 100

highlight ColorColumn ctermbg=lightgray guibg=lightgray

let mapleader = ","  

" File types
au BufNewFile,BufRead *.coffee set filetype=coffee
au BufNewFile,BufRead *.ejs set filetype=html
au BufNewFile,BufRead *.csv,*.dat setfiletype csv
autocmd BufNewFile,BufRead *.less setlocal ft=less
" autocmd BufNewFile,BufRead *.md setlocal ft=markdown

" ---------------------- MAPPING CONFIGURATION ---------------------
nmap <c-s> :w<CR>
imap <c-s> <Esc>:w<CR>a
noremap <leader>q :bp<CR>
noremap <leader>w :bn<CR>
nnoremap <esc> :noh<return><esc>
" use <C-Space> for Vim's keyword autocomplete
inoremap <Nul> <C-n>
" select all
noremap <leader>a ggVG
map <C-k> :bnext<cr>
map <C-j> :bprevious<cr>

" ---------------------- PLUGIN CONFIGURATION ----------------------
let &runtimepath.=',$HOME/.vim/bundle/Vundle.vim'
call vundle#begin()
Plugin 'gmarik/Vundle.vim'
Plugin 'scrooloose/nerdtree'
Plugin 'fholgado/minibufexpl.vim'
"Plugin 'ctrlpvim/ctrlp.vim' <- Use NeoVim fzf instead
Plugin 'Xuyuanp/nerdtree-git-plugin'
Plugin 'vim-scripts/L9'
Plugin 'itchyny/lightline.vim'
Plugin 'Lokaltog/vim-easymotion'
Plugin 'tpope/vim-surround'
Plugin 'tpope/vim-fugitive'
Bundle 'lukaszkorecki/CoffeeTags'
Plugin 'majutsushi/tagbar'
Plugin 'mattn/emmet-vim'
Plugin 'kchmck/vim-coffee-script'
Plugin 'groenewege/vim-less'
Plugin 'skammer/vim-css-color'
Plugin 'junegunn/fzf'
Plugin 'terryma/vim-smooth-scroll'
Plugin 'Shougo/deoplete.nvim'

Plugin 'vim-airline/vim-airline'
Plugin 'vim-airline/vim-airline-themes'
Plugin 'Shougo/unite.vim'
Plugin 'jiangmiao/auto-pairs'
Plugin 'tpope/vim-projectionist'
Plugin 'terryma/vim-multiple-cursors'

Plugin 'chrisbra/csv.vim'
call vundle#end()

" -- Ag --
if executable('ag')
  set grepprg=ag\ --nogroupi\
  "let g:ctrlp_user_command = 'ag %s -l -g ""'
  "let g:ctrlp_use_caching = 0
endif
command -nargs=+ -complete=file -bar Ag silent! grep! <args>|cwindow|redraw!
nnoremap K :Ag<SPACE>

" -- FZF
nnoremap <C-P> :FZF<CR>
let $FZF_DEFAULT_COMMAND = 'ag -l -g ""'
" -- CtrlP --
"let g:ctrlp_by_filename = 1 " default search mode by filename, not regexp

" -- deoplete --
let g:deoplete#enable_at_startup = 1

" -- Emmet --
let g:user_emmet_leader_key = '<c-e>' " use zencoding with <C-E>

" -- NERDTree
"autocmd VimEnter * NERDTree " Start on startup
"autocmd VimEnter * wincmd p " Focus active window

" -- Projectionist
" Create .projections.json at the root of project

" -- Tagbar --
noremap <leader>b :TagbarToggle<cr>
let g:tagbar_usearrows = 1

" -- Vim Smooth Scroll --
noremap <silent> <c-u> :call smooth_scroll#up(&scroll, 0, 2)<CR>
noremap <silent> <c-d> :call smooth_scroll#down(&scroll, 0, 2)<CR>
noremap <silent> <c-b> :call smooth_scroll#up(&scroll*2, 0, 4)<CR>
noremap <silent> <c-f> :call smooth_scroll#down(&scroll*2, 0, 4)<CR>

" ------------------- Test changes ------------------------------
" Sync NERDTree view and current open file
" autocmd BufEnter * if &modifiable | NERDTreeFind | wincmd p | endif
"Use ctags tags
set tags=./tags,tags;
noremap <leader>g <C-]>
set runtimepath^=~/.vim/bundle/majutsushi-tagbar-44ecd8d " official version doesnt work
set runtimepath^=~/.vim/bundle/ag

